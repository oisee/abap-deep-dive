# Патч для важных исправлений Главы 1
# Дата: 2025-07-21
# Применить с помощью скрипта apply_patches.py

## ВАЖНЫЕ ИСПРАВЛЕНИЯ

### Исправление 5: Добавить объяснения аббревиатур Work Process
- Файл: ADD - Глава 1 Анатомия SAP системы.md
- Строка: 189-192
- Найти:
```
- DIA (диалоговые) — обработка интерактивных запросов
- BTC (фоновые) — выполнение batch заданий  
- UPD (update) — обработка обновлений БД
- SPO (spool) — управление печатью
```
- Заменить:
```
- DIA (Dialog) — обработка интерактивных запросов пользователей
- BTC (Background) — выполнение фоновых batch заданий
- UPD (Update) — обработка синхронных обновлений БД (V1)
- UPD2 (Update 2) — обработка асинхронных обновлений БД (V2)
- ENQ (Enqueue) — управление блокировками SAP
- SPO (Spool) — управление печатью и выводом
```
- Причина: Неполный список типов WP и отсутствие расшифровки аббревиатур

### Исправление 6: Добавить значения параметров по умолчанию
- Файл: ADD - Глава 1 Анатомия SAP системы.md
- Строка: 223-227
- Найти:
```
rdisp/wp_no_dia = <количество диалоговых процессов>
rdisp/wp_no_btc = <количество фоновых процессов>
rdisp/wp_no_upd = <количество update процессов>
rdisp/wp_no_spo = <количество spool процессов>
```
- Заменить:
```
rdisp/wp_no_dia = 10  # Типичное значение для среднего сервера
rdisp/wp_no_btc = 3   # Минимум 2 для планировщика заданий
rdisp/wp_no_upd = 2   # Обычно 1-3 в зависимости от нагрузки
rdisp/wp_no_upd2 = 1  # Для асинхронных обновлений V2 (опционально)
rdisp/wp_no_enq = 1   # Только на Central Instance с Enqueue Server
rdisp/wp_no_spo = 1   # Минимум 1 для обработки печати

# Пример для продуктивной системы (500 пользователей):
# DIA=20, BTC=5, UPD=3, UPD2=2, ENQ=1, SPO=2
```
- Причина: Отсутствие конкретных значений затрудняет конфигурирование

### Исправление 7: Добавить стандартные порты SAP
- Файл: ADD - Глава 1 Анатомия SAP системы.md
- Строка: после 150 (добавить новую секцию)
- Добавить:
```
## Стандартные порты SAP

Каждый компонент SAP использует стандартизированную схему портов:

| Компонент | Порт | Описание |
|-----------|------|----------|
| Message Server | 36<NN> | Например, 3600 для instance 00 |
| Dispatcher | 32<NN> | Например, 3200 для instance 00 |
| Gateway | 33<NN> | Например, 3300 для instance 00 |
| ICM HTTP | 80<NN> | Например, 8000 для instance 00 |
| ICM HTTPS | 443<NN> | Например, 44300 для instance 00 |
| Enqueue Server | 39<NN> | Например, 3900 для instance 00 |

где <NN> - номер инстанса (00-99)
```
- Причина: Отсутствие информации о портах затрудняет настройку сети

### Исправление 8: Уточнить лимиты памяти
- Файл: ADD - Глава 1 Анатомия SAP системы.md
- Строка: 509
- Найти: "Application server должен иметь огромные буферы"
- Заменить:
```
Application server выделяет память по следующим лимитам:
- Roll extension: до 2 GB на пользовательский контекст (32-bit системы)
- Heap memory: 2 GB для диалоговых WP (32-bit), без ограничений для 64-bit
- Extended Memory: обычно 16-32 GB начальный размер (em/initial_size_MB)
- Shared Memory: зависит от конфигурации, типично 10-50 GB для буферов

Примечание: В 64-битных системах лимиты определяются только доступной памятью.
```
- Причина: Расплывчатые формулировки без конкретных значений

### Исправление 9: Уточнить версию ENSA2
- Файл: ADD - Глава 1 Анатомия SAP системы.md
- Строка: 380-391
- Найти: "с SAP NetWeaver 7.52"
- Заменить: "с SAP NetWeaver 7.52 SP00 (и выше)"
- Причина: Необходима точная версия для технических спецификаций

### Исправление 10: Исправить пример ABAP кода
- Файл: ADD - Глава 1 Анатомия SAP системы.md
- Строка: 494-502
- Найти: существующий неполный код
- Заменить:
```abap
* Полный рабочий пример обработки больших объемов данных
REPORT z_large_data_processing.

* Объявление типов и переменных
DATA: lt_orders TYPE TABLE OF vbak,
      lt_items  TYPE TABLE OF vbap,
      lt_large_orders TYPE TABLE OF vbak,
      ls_order  TYPE vbak,
      ls_item   TYPE vbap,
      lv_total  TYPE netwr_ak.

* Экран выбора
PARAMETERS: p_date TYPE vbak-erdat DEFAULT sy-datum.

START-OF-SELECTION.
  * Выборка заказов за дату
  SELECT * FROM vbak INTO TABLE lt_orders
    WHERE erdat = p_date.

  * Обработка каждого заказа
  LOOP AT lt_orders INTO ls_order.
    CLEAR lv_total.
    
    * Выборка позиций заказа
    SELECT * FROM vbap INTO TABLE lt_items
      WHERE vbeln = ls_order-vbeln.
    
    * Подсчет суммы заказа
    LOOP AT lt_items INTO ls_item.
      lv_total = lv_total + ls_item-netwr.
    ENDLOOP.
    
    * Отбор крупных заказов (> 10000)
    IF lv_total > 10000.
      APPEND ls_order TO lt_large_orders.
    ENDIF.
  ENDLOOP.

  * Вывод результата
  WRITE: / 'Найдено крупных заказов:', lines( lt_large_orders ).
```
- Причина: Неполный код с необъявленными переменными